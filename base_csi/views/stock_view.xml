<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--  NEW VIEWS -->
    <record model='ir.ui.view' id='view_stock_picking_filter'>
        <field name='name'>x_gfp.inventory.filter.view</field>
        <field name='model'>stock.picking</field>
        <field name='inherit_id' ref='stock.view_picking_internal_search'/>
        <field name='arch' type='xml'>
            <field name="partner_id" position="after">
                <filter name="ticket_id" string="Helpdesk Ticket" domain="[('ticket_id', '!=', False)]"/>
                <filter name="ticket" string="Helpdesk Ticket" domain="[('ticket_id', '=', False)]"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="inventory_form_view_inherit">
        <field name="name">x_gfp.inventory.form.view</field>
        <field name="inherit_id" ref="stock.view_picking_type_form"/>
        <field name="model">stock.picking.type</field>
        <field name="arch" type="xml">
            <field name="barcode" position="after">
                <field name="picking_operation"/>
                <field name="delivery_operation"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="inventory_kanban_view_inherit">
        <field name="name">x_gfp.inventory.kanban.view</field>
        <field name="inherit_id" ref="stock.stock_picking_type_kanban"/>
        <field name="model">stock.picking.type</field>
        <field name="arch" type="xml">
            <xpath expr='//kanban[@class="oe_background_grey o_kanban_dashboard o_emphasize_colors o_stock_kanban"]' position="inside">
                <field name="count_helpdesk_value"/>
                <field name="count_helpdesk_receipt_value"/>
                <field name="count_sale_order_value"/>
                <field name="count_purchase_order_value"/>
                <field name="picking_operation"/>
                <field name="delivery_operation"/>
            </xpath>
            <xpath expr='//kanban//templates//t//div[@class="col-6 o_kanban_primary_left"]//button[@name="get_action_picking_tree_ready"]' position="after">
                <t t-if="record.delivery_operation.raw_value">
	                <button class="btn btn-primary" name="action_helpdesk_picking_tree_ready" type="object" t-if="record.delivery_operation.raw_value">
	                    <span >
	                        <t t-esc="record.count_helpdesk_value.value"/>
	 Helpdesk Orders to Process</span>
	                </button>
	                <br/>
	                <br/>
	                <button class="btn btn-primary" name="action_sale_order_picking_tree_ready" type="object" t-if="record.delivery_operation.raw_value">
	                    <span >
	                        <t t-esc="record.count_sale_order_value.value"/>
	 Sales Orders to Process</span>
	                </button>
				</t>
				<t t-if="record.picking_operation.raw_value">
	                <button class="btn btn-primary" name="action_helpdesk_receipt_tree_ready" type="object" t-if="record.picking_operation.raw_value">
	                    <span >
	                        <t t-esc="record.count_helpdesk_receipt_value.value"/>
	 Helpdesk Receipts to Process</span>
	                </button>
	                <br/>
	                <br/>
	                <button class="btn btn-primary" name="action_purchase_order_picking_tree_ready" type="object" t-if="record.picking_operation.raw_value">
	                    <span >
	                        <t t-esc="record.count_purchase_order_value.value"/>
	 Purchase Receipts to Process</span>
	                </button>
                </t>
            </xpath>
            <xpath expr='//kanban//templates//t//div[@class="col-6 o_kanban_primary_left"]//button[@name="get_action_picking_tree_ready"]' position="attributes">
                <attribute name="attrs">{'invisible': ['|',('picking_operation', '=', True), ('delivery_operation', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>

    <!-- Helpdesk Ticket form view -->
    <record id="action_picking_helpdesk_form" model="ir.actions.act_window">
        <field name="name">Transfer</field>
        <field name="res_model">stock.picking</field>
        <field name="type">ir.actions.act_window</field>
        <field name="view_mode">form</field>
        <field name="domain"></field>
        <field name="context">{
                'search_default_picking_type_id': [1],
                'default_picking_type_id': 1,
                'contact_display': 'partner_address',
        }
        </field>
        <field name="search_view_id" ref="stock.view_picking_internal_search" />
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create a new transfer
            </p>
            <p>
                Transfers allow you to move products from one location to another.
            </p>
        </field>
    </record>
    
	<record model="ir.ui.view" id="view_picking_form_mod">
        <field name="name">x_gfp.stock.picking.form.mod</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form" />
        <field name="priority">98</field>
        <field name="arch" type="xml">
            <xpath expr="//header" position="after">
                <div align="center" style="background-color:#CB4335;color:white;" attrs="{'invisible':[('return_picking_id','=', False)]}">
                    <div>
                        <strong>CONNECTED TO A RETURN ORDER</strong>
                    </div>
                    <div>
                        <strong>Include return shipping label in box and record return tracking reference.</strong>
                    </div>
                </div>
            </xpath>
            <xpath expr="//field[@name='partner_id']/../div" position="before">
                <label for="ss_id" attrs="{'invisible':[('ss_id','=',0)]}" />
                <div attrs="{'invisible':[('ss_id','=',0)]}">
                    <field name="ss_id" readonly="1" attrs="{'invisible':[('ss_id','=',0)]}" />
                    |
                    <field name="ss_status" readonly="1" attrs="{'invisible':[('ss_id','=',0)]}" />
                    |
                    <field name="ss_address_status" readonly="1" attrs="{'invisible':[('ss_id','=',0)]}" />
                    |
                    <button name="delete_ssorder" string="Cancel" type="object" attrs="{'invisible':[('ss_status','=','cancelled')]}" invisible="1" />
                </div>
                <field name="ss_ship_id" attrs="{'invisible':[('ss_ship_id','=',0)]}" />
            </xpath>
            <xpath expr="//field[@name='carrier_id']" position="replace" />
            <xpath expr="//field[@name='origin']" position="after">
                <field name="carrier_id" options="{'no_create': True, 'no_open': True}" />
                <field name="delivery_carrier_code" invisible="1" />
                <field name="delivery_package" />
                <label string="Dimensions" for="delivery_length" />
                <div class="o_address_format">
                    <field name="delivery_length" class="o_address_zip" />
                    X
                    <field name="delivery_width" class="o_address_zip" />
                    X
                    <field name="delivery_height" class="o_address_zip" />
                </div>
                <field name="client_account" domain="[('partner_id','=',partner_id)]" />
                <field name="confirmation" />
                <field name="delivery_type" attrs="{'invisible':True}" />
                <field name="carrier_tracking_ref" class="oe_inline" attrs="{'readonly': [('state', '=', 'done')]}" />
            </xpath>
            <xpath expr="//field[@name='backorder_id']" position="after">
                <field name="sale_id" />
                <field name="salesforce_order" />
                <field name="purchase_id" />
                <field name="ticket_id" />
                <field name="return_picking_id" attrs="{'invisible': [('ticket_id','=',False)]}" domain="[('ticket_id','=', ticket_id), ('name','!=',name)]" />
                <field name="return_carrier_tracking_ref" attrs="{'invisible': [('return_picking_id','=',False)]}" />
            </xpath>
            <xpath expr="//header" position="inside">
                <field name="return_location" invisible="1" />
                <button name="create_update_ssorder" string="Send to Shipstation" type="object" class="oe_highlight" attrs="{'invisible':['|','|',('picking_type_code','!=','outgoing'),('ss_id','!=',0),('state','not in',['assigned'])]}" />
                <button name="ship_ssorder" string="Print Label" type="object" class="oe_highlight" attrs="{'invisible':['|',('ss_status','!=','awaiting_shipment'),('state','not in',['assigned'])]}" />
                <button name="create_update_ssorder" string="Send to Shipstation" type="object" class="oe_highlight" attrs="{'invisible':['|','|',('picking_type_code','!=','incoming'),('ss_id','!=',0),('return_location','=',False)]}" />
                <button name="ship_ssorder" string="Print Label" type="object" class="oe_highlight" attrs="{'invisible':['|',('ss_status','!=','awaiting_shipment'),('return_location','=',False)]}" />
                <button name="cancel_shipstation_order" string="Cancel Shipstation Order" type="object" class="oe_highlight" attrs="{'invisible':['|','|',('ss_id','=',0),('ss_status','=','cancelled'),('state','not in',['assigned'])]}" />
                <button name="cancel_shipstation_order" string="Cancel Shipstation Order" type="object" class="oe_highlight" attrs="{'invisible':['|','|',('ss_id','=',0),('ss_status','=','cancelled'),('return_location','=',False)]}" />
            </xpath>
            <xpath expr="//button[@name='do_unreserve']" position="after">
                <button name="unreserve_lot_sn" string="UNRESERVE LOT/SN" type="object" groups="base.group_user" attrs="{'invisible': ['|', '|', '|', '|', ('picking_type_code', '=', 'incoming'), ('immediate_transfer', '=', True), ('is_locked', '=', False), '&amp;', ('state', 'not in', ('assigned', 'partially_available')), ('move_type', '!=', 'one'), '&amp;', ('state', 'not in', ('assigned', 'partially_available', 'confirmed')), ('move_type', '=', 'one')]}"/>
            </xpath>
            <xpath expr="//button[@name='button_validate']" position="replace" />
            <xpath expr="//button[@name='button_validate']" position="replace">
                <button name="approve_picking" attrs="{'invisible': ['|', '|', ('approved','=',True),('state', 'in', ('waiting','confirmed')), ('show_validate', '=', False)]}" string="Approve" type="object" class="oe_highlight" groups="stock.group_stock_user" />
                <button name="approve_picking" attrs="{'invisible': ['|', '|', ('approved','=',True),('state', 'not in', ('waiting', 'confirmed')), ('show_validate', '=', False)]}" string="Approve" type="object" groups="stock.group_stock_user" class="o_btn_validate" />
                <button name="button_validate" attrs="{'invisible': ['|', '|', ('approved','!=',True),('state', 'in', ('waiting','confirmed')), ('show_validate', '=', False)]}" string="Validate" type="object" class="oe_highlight" groups="stock.group_stock_user" />
                <button name="button_validate" attrs="{'invisible': ['|', '|', ('approved','!=',True),('state', 'not in', ('waiting', 'confirmed')), ('show_validate', '=', False)]}" string="Validate" type="object" groups="stock.group_stock_user" class="o_btn_validate" />
            </xpath>
            <xpath expr="//button[@name='action_cancel']" position="attributes">
                <attribute name="context">{'action_button_call': True}</attribute>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Approvals">
                    <group>
                        <field name="approval_ids" nolabel="1" widget="one2many_list" readonly="1">
                            <tree>
                                <field name="name" />
                                <field name="create_date" string="Approval Date" />
                            </tree>
                        </field>
                    </group>
                    <group>
                        <field name="approved" invisible="1" />
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record id="view_picking_withcarrier_out_form_mod" model="ir.ui.view">
        <field name="name">x_gfp.delivery.stock.picking_withcarrier.form.view.mod</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="delivery.view_picking_withcarrier_out_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='shipping_weight']" position="after">
                <field name="ss_order_weight" />
            </xpath>
        </field>
    </record>
    
</odoo>